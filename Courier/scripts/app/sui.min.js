var Courier,courier;(function(n){"use strict";function t(n){return n===undefined?!0:n===null?!0:n==={}?!0:n===[]?!0:String(n).trim().length===0?!0:!1}function i(n,i){return t(n)?i:n}function r(n,t,r){var u,f;return t===void 0&&(t=""),r===void 0&&(r=[]),u=angular.lowercase(String(n)).trim(),r.length>0&&(f=!1,angular.forEach(r,function(n){angular.lowercase(n).trim()===u&&(f=!0)}),f||(u=undefined)),i(u,angular.lowercase(t).trim())}function u(n,i){if(t(n))return undefined;var f="YYYY-MM-DD",u;switch(r(i)){case"date":switch(r(n)){case"today":u=moment().format(f);break;case"tomorrow":u=moment().add(1,"day").format(f);break;case"yesterday":u=moment().subtract(1,"day").format(f);break;default:u=moment(n).format(f);angular.lowercase(u).indexOf("invalid")>=0&&(u=null)}break;case"number":u=angular.isNumber(n)?Number(n):null;break;case"boolean":u=Boolean(n);break;case"xml":u=angular.toJson(n);break;default:u=String(n).trim()}return u}var f,e,o,s,h;n.IsBlank=t;n.IfBlank=i;n.Option=r;n.Cast=u,function(n){var t=function(){function n(n,t){var i=this;this.$scope=n;this.$log=t;this.procedures={};this.addProcedure=function(n,t){i.procedures[n]=t};this.removeProcedure=function(n){angular.isDefined(i.procedures[n])&&delete i.procedures[n]};this.execute=this.$scope.execute=function(n){i.procedures[n]()}}return n.$inject=["$scope","$log"],n}();n.Controller=t}(f=n.Main||(n.Main={})),function(n){var u=function(){function n(n,r,u,f){var e=this;this.$scope=n;this.$parse=r;this.$log=u;this.$window=f;this.parameters=[];this.addParameter=function(n){e.parameters.push(n)};this.removeParameter=function(n){var t=e.parameters.indexOf(n);t>=0&&e.parameters.splice(t,1)};this.empty=function(){t(e.$scope.model)||(e.model=e.type==="array"?[]:{})};this.execute=function(){e.empty();var n={name:e.name,parameters:[],type:e.type,token:i(e.$window.localStorage.getItem("token"),null)};angular.forEach(e.parameters,function(t){n.parameters.push(t())});e.$log.debug("Execute:"+angular.toJson(n))};this.initialize=function(){e.run!=="manual"?e.execute():e.empty();e.run==="auto"&&e.$scope.$watch(function(){return e.parameters.length},function(n,t){n!==t&&e.execute()})}}return Object.defineProperty(n.prototype,"name",{get:function(){return this.$scope.name},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"alias",{get:function(){return i(this.$scope.alias,this.$scope.name)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"model",{get:function(){return t(this.$scope.model)?undefined:this.$parse(this.$scope.model)(this.$scope.$parent)},set:function(n){t(this.$scope.model)||this.$parse(this.$scope.model).assign(this.$scope.$parent,n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"type",{get:function(){return t(this.$scope.model)?"execute":t(this.$scope.type)?t(this.$scope.root)?"array":"object":r(this.$scope.type,"array",["singleton","object"])},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"root",{get:function(){return this.type==="object"?i(this.$scope.root,undefined):undefined},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"run",{get:function(){return r(this.$scope.run,"manual",["auto","once"])},enumerable:!0,configurable:!0}),n.$inject=["$scope","$parse","$log","$window"],n}();n.Controller=u}(e=n.Procedure||(n.Procedure={})),function(n){var f=function(){function n(n,t,i){var r=this;this.$scope=n;this.$routeParams=t;this.$parse=i;this.factory=function(){return{name:r.name,value:r.value,xml:r.xml,required:r.required}}}return Object.defineProperty(n.prototype,"name",{get:function(){return this.$scope.name},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"type",{get:function(){return t(this.$scope.type)?t(this.$scope.value)?"route":"value":r(this.$scope.type,"value",["route","scope"])},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){var n=undefined;switch(this.type){case"route":n=this.$routeParams[i(this.$scope.value,this.$scope.name)];break;case"scope":n=this.$parse(this.$scope.value)(this.$scope.$parent);break;default:n=this.$scope.value}return i(u(n,this.$scope.format),null)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"xml",{get:function(){return r(this.$scope.format)==="xml"},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"required",{get:function(){return r(this.$scope.required)==="true"},enumerable:!0,configurable:!0}),n.$inject=["$scope","$routeParams","$parse"],n}();n.Controller=f}(o=n.Parameter||(n.Parameter={})),function(n){var r=function(){function n(n,i,r,u){var f=this;this.$scope=n;this.$window=i;this.$location=r;this.$route=u;this.back=function(){t(f.$scope.back)?f.$window.history.back():f.$location.path(f.$scope.back)};this.undo=function(){f.$route.reload()};this.save=undefined;this.delete=undefined}return Object.defineProperty(n.prototype,"heading",{get:function(){return i(this.$scope.heading,undefined)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"subheading",{get:function(){return i(this.$scope.subheading,undefined)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"canEdit",{get:function(){return!t(this.$scope.save)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"saveProcedure",{get:function(){return i(this.$scope.save,undefined)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"canDelete",{get:function(){return!t(this.$scope.delete)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"deleteProcedure",{get:function(){return i(this.$scope.delete,undefined)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"dirty",{get:function(){return this.$scope.form.$dirty},enumerable:!0,configurable:!0}),n.$inject=["$scope","$window","$location","$route"],n}();n.Controller=r}(s=n.Form||(n.Form={})),function(n){var t=function(){function n(n,t){var i=this;this.$scope=n;this.$log=t;this.validators=[];this.addValidator=function(n){i.validators.push(n)};this.removeValidator=function(n){var t=i.validators.indexOf(n);t>=0&&i.validators.splice(t,1)}}return Object.defineProperty(n.prototype,"heading",{get:function(){return i(this.$scope.heading,undefined)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hasError",{get:function(){var t=this,n=!1;return angular.forEach(this.validators,function(i){i()||(n=!0);t.$log.debug(n)}),n},enumerable:!0,configurable:!0}),n.$inject=["$scope","$log"],n}();n.Controller=t}(h=n.FormItem||(n.FormItem={}))})(Courier||(Courier={}));courier=angular.module("Courier",["ngRoute","ui.bootstrap","templates/couForm.html","templates/couFormItem.html"]);courier.directive("courier",function(){return{restrict:"E",scope:{},controller:Courier.Main.Controller,require:["courier"],link:function(){}}});courier.directive("couProcedure",function(){return{restrict:"E",scope:{name:"@",model:"@",type:"@",root:"@",run:"@"},controller:Courier.Procedure.Controller,require:["couProcedure","^courier"],link:function(n,t,i,r){r[0].initialize();r[1].addProcedure(r[0].alias,r[0].execute);n.$on("$destroy",function(){r[0].model=undefined;r[1].removeProcedure(r[0].alias)})}}});courier.directive("couParameter",function(){return{restrict:"E",scope:{name:"@",type:"@",value:"@",format:"@",required:"@"},controller:Courier.Parameter.Controller,require:["couParameter","^couProcedure"],link:function(n,t,i,r){r[1].addParameter(r[0].factory);n.$on("$destroy",function(){r[1].removeParameter(r[0].factory)});r[1].run==="auto"&&n.$watch(function(){return r[0].value},function(n,t){n!==t&&r[1].execute()})}}});courier.directive("couForm",function(){return{restrict:"E",templateUrl:"templates/couForm.html",transclude:!0,scope:{heading:"@",subheading:"@",back:"@",save:"@","delete":"@"},controller:Courier.Form.Controller,controllerAs:"ctrl",require:["couForm","^courier"],link:function(n,t,i,r){r[0].canEdit&&(r[0].save=function(){r[1].execute(r[0].saveProcedure)});r[0].canDelete&&(r[0].delete=function(){r[1].execute(r[0].deleteProcedure)})}}});courier.directive("couFormItem",function(){return{restrict:"E",templateUrl:"templates/couFormItem.html",transclude:!0,scope:{heading:"@"},controller:Courier.FormItem.Controller,controllerAs:"ctrl"}});courier.directive("couValidator",function(){return{restrict:"E",scope:{fn:"&"},require:"^couFormItem",link:function(n,t,i,r){r.addValidator(n.fn);n.$on("$destroy",function(){r.removeValidator(n.fn)})}}});angular.module("templates/couForm.html",[]).run(["$templateCache",function(n){n.put("templates/couForm.html",'<div class="panel panel-default form-horizontal" ng-form="form"><div class="panel-heading"><h4><b>{{ctrl.heading}}<\/b><span ng-if="ctrl.subheading"><br /><small>{{ctrl.subheading}}<\/small><\/span><\/h4><\/div><div class="panel-body" ng-transclude><\/div><div class="panel-footer clearfix"><div class="pull-right"><div ng-if="form.$pristine"><div class="btn-group"><button ng-if="ctrl.canDelete" type="button" class="btn btn-danger" ng-click="ctrl.delete()"><i class="fa fa-trash-o"><\/i> Delete<\/button><button type="button" class="btn btn-default" ng-click="ctrl.back()"><i class="fa fa-chevron-circle-left"><\/i> Back<\/button><\/div><\/div><div ng-if="form.$dirty"><div class="btn-group"><button type="reset" class="btn btn-warning" ng-click="ctrl.undo()"><i class="fa fa-undo"><\/i> Undo<\/button><button type="submit" class="btn btn-primary" ng-click="ctrl.save()"><i class="fa fa-save"><\/i> Save<\/button><\/div><\/div><\/div><\/div><\/div>')}]);angular.module("templates/couFormItem.html",[]).run(["$templateCache",function(n){n.put("templates/couFormItem.html",'<div class="form-group" ng-form="form"><label class="control-label col-sm-3">{{ctrl.heading}} {{ctrl.hasError}}<\/label><div class="col-sm-9" ng-transclude><\/div><\/div>')}]);
//# sourceMappingURL=sui.min.js.map
